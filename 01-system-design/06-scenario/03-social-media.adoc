=  Social Media
:toc: macro
:toclevels: 2
:sectnums:
:icons: font
:source-highlighter: rouge

A social media platform like Twitter (now X) enables users to post short messages ("tweets"), follow others, like and comment, and view a real-time feed. It must support high volumes of reads and writes, scale globally, deliver low-latency feeds, and ensure eventual consistency across services like notifications, analytics, and timelines. The design should balance personalization, fan-out strategies, and throughput optimization.

== System Architecture

=== C1 Context Diagram

[source, mermaid]
----
C4Context
title System Context - Social Media Feed

Enterprise_Boundary(b0, "X Platform") {
  Person(user, "ğŸ§‘ User", "Person who posts, follows, and views feeds")

  System(feed_system, "ğŸ“£ Feed Platform", "Handles tweets, timelines, likes, followers, and interactions")

  System_Ext(notification_system, "ğŸ”” Notification System", "Push/email notifications to users")
  System_Ext(media_service, "ğŸ–¼ï¸ Media Storage", "Stores uploaded media (images, videos)")
  System_Ext(auth_service, "ğŸ” Auth Service", "Authentication and session management")
  System_Ext(analytics_system, "ğŸ“Š Analytics Platform", "Tracks user behavior and engagement")

  Rel(user, feed_system, "Posts and reads tweets")
  Rel(feed_system, auth_service, "Validates sessions")
  Rel(feed_system, notification_system, "Sends alerts for likes/comments/follows")
  Rel(feed_system, media_service, "Uploads or retrieves media")
  Rel(feed_system, analytics_system, "Sends user activity data")
}
----

=== C2 Container Diagram

[source, mermaid]
----
C4Container
title Container Diagram - Social Media Feed (X)

System_Ext(notification_system, "ğŸ”” Notification System", "External push/email infrastructure", $tags="v1.0")
System_Ext(media_service, "ğŸ–¼ï¸ Media Service", "Stores and serves images/videos", $tags="v1.0")
System_Ext(auth_service, "ğŸ” Auth Service", "Authentication and token validation", $tags="v1.0")
System_Ext(analytics_system, "ğŸ“Š Analytics Service", "Collects engagement metrics", $tags="v1.0")
Person(user, "ğŸ§‘ User", "Person who interacts with the platform via web or mobile", $tags="v1.0")

Container_Boundary(c1, "ğŸ“£ Feed System") {
  Container(web_app, "ğŸŒ Web App", "React", "Web interface to browse, post, and interact with tweets")
  Container(mobile_app, "ğŸ“± Mobile App", "Flutter", "Mobile access to feed and user actions")
  Container(api_gateway, "ğŸ›¡ API Gateway", "Spring Cloud Gateway", "Entry point for clients and routing")
  Container(user_service, "ğŸ§‘â€ğŸ¤â€ğŸ§‘ User Service", "Java, Spring Boot", "Handles profiles, followers, and authentication integration")
  Container(tweet_service, "ğŸ¦ Tweet Service", "Java, Spring Boot", "Manages posting, deleting, and retrieving tweets")
  Container(feed_service, "ğŸ“¥ Feed Service", "Java, Spring Boot", "Assembles personalized timelines")
  Container(interaction_service, "â¤ï¸ Interaction Service", "Java, Spring Boot", "Handles likes, retweets, and comments")
  ContainerDb(database, "ğŸ—ƒï¸ Feed Database", "Cassandra", "Stores tweets, timelines, and interactions")
  Container(cache, "âš¡ Redis Cache", "Redis", "Caches hot feeds and trending posts")
}

Rel(user, web_app, "Uses", "HTTPS")
Rel(user, mobile_app, "Uses", "HTTPS")
Rel(web_app, api_gateway, "Calls", "HTTPS")
Rel(mobile_app, api_gateway, "Calls", "HTTPS")

Rel(api_gateway, user_service, "Routes auth/profile requests", "REST")
Rel(api_gateway, tweet_service, "Routes tweet actions", "REST")
Rel(api_gateway, feed_service, "Routes feed queries", "REST")
Rel(api_gateway, interaction_service, "Routes likes/comments", "REST")

Rel(tweet_service, database, "Stores tweets", "Async/Batch")
Rel(feed_service, cache, "Reads hot timelines", "Redis")
Rel(feed_service, database, "Reads personalized timeline", "Cassandra")
Rel(interaction_service, database, "Updates likes/comments", "Async")
Rel(tweet_service, media_service, "Uploads/loads media", "HTTPS")
Rel(user_service, auth_service, "Validates token", "HTTPS")
Rel(tweet_service, analytics_system, "Tracks tweet activity", "Async")
Rel(interaction_service, notification_system, "Triggers notifications", "HTTPS")
----

=== System Integration Flow

[source, mermaid]
----
----